<html>
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="js/elastos-wallet-api-min.js"></script>
<script src="js/did.js"></script>
<script src="js/CryptoJS/rollups/md5.js"></script>
<script type="text/javascript">

    const done = () => {
        var appname = document.getElementById("appname").value

        if (appname == "") {
            alert("请输入应用名称")
            return
        }

        var mnemonic = document.getElementById("mnemonic").value
        if (mnemonic == "") {
            alert("请输入助记词")
            return
        }

        var json = restoreDid(mnemonic)

        var appId = sign(appname, json.privateKey)

        var ret = "AppName: " + appname + "<br/>" + "AppID: " + appId + "<br/>"

        document.getElementById("appId").innerHTML = ret

        setInfo(accId, accSecret, "Dev/" + appname + "/AppID", appId, json.mnemonic)
        .then(ret => {
            document.getElementById("txid").innerHTML = "Txid: " + ret.txid
        })

    }

    const doverify = () => {
        var appname = document.getElementById("appname_input").value

        if (appname == "") {
            alert("请输入应用名称")
            return
        }

        var appId = document.getElementById("appId_input").value
        if (appId == "") {
            alert("请输入AppID")
            return
        }

        var publicKey = document.getElementById("publickey").value
        if (publicKey == "") {
            alert("请输入public key")
            return
        }

        var ret = verify(appname, appId, publicKey)

        alert("验证结果" + ret)

    }

</script>

<style>
    textarea {
        font-size: 20px;
        vertical-align: middle;
    }

    lable {
        text-align: center;
        vertical-align: middle;
    }

</style>
</head>
<body>

<p style="font-size: 24px;">生成AppID</p>
<div>
    <lable >应用名称</lable>
    <textarea id="appname" style="width:450px; height: 30px; padding-left: 10px;" row="1"></textarea>
</div>
<br/>

<div>
    <lable >助记词</lable>
    <textarea id="mnemonic" style="width:800px; height: 30px; padding-left: 10px;" row="1"></textarea>
</div>
<br/>

<div>
<button type="button" onclick="done()" style="width:100px; height:30px;">完成</button>
</div>

<br/>

<br/>
<p id="appId" style="word-wrap:break-word;"></p>
<p id="txid" style="word-wrap:break-word;"></p>

<p style="font-size: 24px;">验证AppID</p>
<div>
    <lable >应用名称(或者原始数据)</lable>
    <textarea id="appname_input" style="width:450px; height: 30px; padding-left: 10px;" row="1"></textarea>
</div>
<br/>

<div>
    <lable >AppID(或者签名后数据)</lable>
    <textarea id="appId_input" style="width:800px; height: 60px; padding-left: 10px;" row="1"></textarea>
</div>
<br/>

<div>
    <lable >PublicKey</lable>
    <textarea id="publickey" style="width:850px; height: 30px; padding-left: 10px;" row="1"></textarea>
</div>
<br/>

<div>
<button type="button" onclick="doverify()" style="width:100px; height:30px;">完成</button>
</div>

<br/>

</body>
</html>
